<div class="calcHeight flex flex-col justify-between">
  <!-- GENERAL REPORT -->
  <div class="flex justify-between h-[29%] flex-grow-0">
    <!-- INCOME -->
    <div
      class="h-full w-[32%] p-4 border border-cm-brown-50 rounded-xl shadow-lg bg-white flex flex-col justify-between"
    >
      <div class="flex flex-col">
        <div class="flex justify-between">
          <span class="font-semibold">Income by</span>
          <select
            [(ngModel)]="incomeMonth"
            id=""
            class="bg-white w-fit text-xs text-neutral-700 border border-neutral-400 focus:outline-blue-500 rounded-md mt-2"
          >
            <option *ngFor="let opt of dateOptions" [value]="opt">
              {{ opt }}
            </option>
          </select>
        </div>
        <select
          (change)="countIncNom(); retrieveIncomeListDetail(incomeCategory)"
          [(ngModel)]="incomeCategory"
          id=""
          class="bg-white w-fit text-xs text-neutral-700"
        >
          <option *ngFor="let opt of incomeOptions" [value]="opt">
            {{ opt }}
          </option>
        </select>
      </div>
      <span class="font-nunito text-[30px] font-bold text-cm-green-700">{{
        incomeNominal
      }}</span>
    </div>
    <!-- OUTCOME -->
    <div
      class="h-full w-[32%] p-4 border border-cm-brown-50 rounded-xl shadow-lg bg-white flex flex-col justify-between"
    >
      <div class="flex flex-col">
        <div class="flex justify-between">
          <span class="font-semibold">Outcome by</span>
          <select
            id=""
            class="bg-white w-fit text-xs text-neutral-700 border border-neutral-400 focus:outline-blue-500 rounded-md mt-2"
          >
            <option *ngFor="let opt of dateOptions" [value]="opt">
              {{ opt }}
            </option>
          </select>
        </div>
        <select
          (change)="countOutNom(); retrieveOutcomeListDetail(outcomeCategory)"
          [(ngModel)]="outcomeCategory"
          id=""
          class="bg-white w-fit text-xs text-neutral-700"
        >
          <option *ngFor="let opt of outcomeOptions" [value]="opt">
            {{ opt }}
          </option>
        </select>
      </div>
      <span class="font-nunito text-[30px] font-bold text-red-800">{{
        outcomeNominal
      }}</span>
    </div>
    <!-- SUMMARY -->
    <div
      class="h-full w-[32%] p-4 border border-cm-brown-50 rounded-xl shadow-lg bg-white"
    >
      <span class="font-semibold">Summary</span>
    </div>
  </div>

  <!-- DETAIL -->
  <div class="flex h-[68%] justify-between">
    <div class="flex flex-col border border-brown-50 bg-white rounded-xl shadow-xl w-[70%]">
      <span class="mt-4 mb-1 ml-4 font-semibold text-neutral-900"
        >Financial Detail</span
      >
      <div
        class=" "
      >
        <div class="flex mx-4 mb-4 justify-between ">
          <!-- DETAIL INCOME -->
          <div class="relative h-full w-[49%]">
            <span class="text-xs font-bold">Income</span>
            <!-- head table income -->
            <div
              class="grid grid-cols-10 text-xs pl-1.5 h-6 rounded-t-lg text-neutral-50 bg-cm-green-500"
            >
              <div class="flex items-center col-start-1 col-end-3">
                {{ incomeCategory === "All Category" ? "No" : "Date" }}
              </div>
              <div class="flex items-center col-start-3 col-end-5">Tipe</div>
              <div class="flex items-center col-start-5 col-end-8">Nominal</div>
              <div class="flex items-center col-start-8 col-end-11 ml-2">Ket.</div>
            </div>
            <!-- body table JIKA incomeCategory bukan 'All Category' -->
            <div *ngIf="incomeCategory !== 'All Category'">
              <div
                *ngIf="incomeListDetail$ | async as incList"
                class="border border-cm-green-500 border-t-0"
              >
                <div
                  *ngFor="let incData of incList.data; let i = index"
                  class="grid grid-cols-11 text-xs pl-1.5 h-5 text-neutral-900"
                  [ngClass]="i % 2 !== 0 ? 'bg-cm-green-500 bg-opacity-20' : ''"
                >
                  <div class="flex items-center col-start-1 col-end-3 text-xs">
                    {{ showSimpleDate(incData.dateIncome) }}
                  </div>
                  <div class="flex items-center col-start-3 col-end-6">
                    {{ incomeCategory }}
                  </div>
                  <div class="flex items-center col-start-6 col-end-8 pt-0.5">
                    <span *ngIf="incomeCategory === 'Persembahan'">{{
                      incData.incomeGive
                    }}</span>
                    <span *ngIf="incomeCategory === 'Perpuluhan'">{{
                      incData.incomeTenth
                    }}</span>
                    <span *ngIf="incomeCategory === 'Pembangunan'">{{
                      incData.incomeBuilding
                    }}</span>
                    <span *ngIf="incomeCategory === 'Service'">{{
                      incData.incomeService
                    }}</span>
                    <span *ngIf="incomeCategory === 'Donasi'">{{
                      incData.incomeDonate
                    }}</span>
                    <span *ngIf="incomeCategory === 'Lainnya'">{{
                      incData.incomeOther
                    }}</span>
                  </div>
                  <div class="flex items-center col-start-8 col-end-12 ml-2">
                    {{ incData.description }}
                  </div>
                </div>
              </div>
            </div>
            <!-- body table JIKA incomeCategory = 'All Category' -->
            <div *ngIf="incomeCategory === 'All Category'">
              <div
                *ngFor="
                  let incOpt of incomeOptions;
                  let i = index;
                  let f = first;
                  let l = last
                "
                class="grid grid-cols-11 text-xs pl-1.5 h-5 text-neutral-900 border border-x-cm-green-500"
                [ngClass]="
                  i % 2 !== 0
                    ? 'bg-cm-green-500 bg-opacity-20'
                    : l
                    ? 'border-t-cm-green-500 border-x-0 border-b-0'
                    : ''
                "
              >
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-1 col-end-3 mt-[-40px]"
                >
                  {{ i }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-3 col-end-6 mt-[-40px]"
                >
                  {{ incOpt }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-6 col-end-8 mt-[-40px]"
                >
                  {{ countIncomePerCat(incOpt) }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-8 ml-2 col-end-12 mt-[-40px]"
                >
                  No Desc
                </div>
              </div>
            </div>
          </div>
    
          <!-- DETAIL OUTCOME -->
          <div class="relative h-full w-[49%]">
            <span class="text-xs font-bold">Outcome</span>
            <!-- head table income -->
            <div
              class="grid grid-cols-10 text-xs pl-1.5 h-6 rounded-t-lg text-neutral-50 bg-red-800"
            >
              <div class="flex items-center col-start-1 col-end-3">
                {{ outcomeCategory === "All Category" ? "No" : "Date" }}
              </div>
              <div class="flex items-center col-start-3 col-end-5">Tipe</div>
              <div class="flex items-center col-start-5 col-end-8">Nominal</div>
              <div class="flex items-center col-start-8 col-end-11">Ket.</div>
            </div>
            <!-- body table JIKA outcomeCategory bukan 'All Category' -->
            <div *ngIf="outcomeCategory !== 'All Category'">
              <div
                *ngIf="outcomeListDetail$ | async as outList"
                class="border border-red-800 border-t-0"
              >
                <div
                  *ngFor="let outcData of outList.data; let i = index"
                  class="grid grid-cols-11 text-xs pl-1.5 h-5 text-neutral-900"
                  [ngClass]="i % 2 !== 0 ? 'bg-red-500 bg-opacity-20' : ''"
                >
                  <div class="flex items-center col-start-1 col-end-3">
                    {{ outcData.dateOutcome | date : "dd/MM/yy" }}
                  </div>
                  <div class="flex items-center col-start-3 col-end-7">
                    {{ outcomeCategory }}
                  </div>
                  <div class="flex items-center col-start-7 col-end-9">
                    <span *ngIf="outcomeCategory === 'Deposit'">{{
                      outcData.outcomeDeposit
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Pembangunan'">{{
                      outcData.outcomeBuilding
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Diakonia'">{{
                      outcData.outcomeDiakonia
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Pelayanan'">{{
                      outcData.outcomeGuest
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Operasional'">{{
                      outcData.outcomeOperational
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Acara'">{{
                      outcData.outcomeEvent
                    }}</span>
                    <span *ngIf="outcomeCategory === 'Lainnya'">{{
                      outcData.outcomeOther
                    }}</span>
                  </div>
                  <div class="flex items-center col-start-9 col-end-12">
                    {{ outcData.description }}
                  </div>
                </div>
              </div>
            </div>
            <!-- body table JIKA outcomeCategory = 'All Category' -->
            <div *ngIf="outcomeCategory === 'All Category'">
              <div
                *ngFor="
                  let outOpt of outcomeOptions;
                  let i = index;
                  let f = first;
                  let l = last
                "
                class="grid grid-cols-11 text-xs pl-1.5 h-5 text-neutral-900 border border-x-red-800"
                [ngClass]="
                  l
                    ? 'border border-t-red-800 border-x-0 border-b-0'
                    : i % 2 !== 0
                    ? 'bg-red-800 bg-opacity-20'
                    : ''
                "
              >
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-1 col-end-3 mt-[-40px]"
                >
                  {{ i }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-3 col-end-7 mt-[-40px]"
                >
                  {{ outOpt }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-7 col-end-9 mt-[-40px]"
                >
                  {{ countOutcomePerCat(outOpt) }}
                </div>
                <div
                  *ngIf="!f"
                  class="flex items-center col-start-9 col-end-12 mt-[-40px]"
                >
                  No Desc
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- INPUT -->
    <div class="p-4 border border-brown-50 bg-white rounded-xl shadow-xl w-[29%] h-fit">
      <div class="flex" [ngClass]="!isAddIncomeActive && !isAddOutcomeActive ? 'justify-start':'justify-between'">
        <span class="mb-1 font-semibold text-neutral-900"
          >Financial Form</span
        >
        <i-feather *ngIf="isAddIncomeActive || isAddOutcomeActive" name="x" style="height: 18px; width: 18px;" class="text-red-700 cursor-pointer" (click)="isAddIncomeActive = false; isAddOutcomeActive = false;"></i-feather>
      </div>
      <div class="flex items-center">
        <!-- Button add income/outcome -->
        <div class="w-full flex mb-1" [ngClass]="!isAddIncomeActive && !isAddOutcomeActive ? 'justify-center mt-2':'justify-end'">
          <app-button
          class="mr-1"
            color="secondary"
            size="small"
            [disableTerm]="isAddIncomeActive"
            (onButtonClick)="isAddIncomeActive = true; isAddOutcomeActive = false"
            ><i-feather name="plus" style="height: 16px; width: 16px;" class="mr-1"></i-feather> Income</app-button
          >
          <app-button color="error" (onButtonClick)="isAddOutcomeActive = true; isAddIncomeActive = false" [disableTerm]="isAddOutcomeActive" size="small"><i-feather name="plus" style="height: 16px; width: 16px;"></i-feather> Outcome</app-button>
        </div>
      </div>

      <!-- head table input -->
      <div
        class="grid grid-cols-11 text-xs" [ngClass]="!isAddIncomeActive && !isAddOutcomeActive ? 'hidden':'pl-1.5 rounded-t-lg h-6 bg-black text-neutral-100'"
      >
        <div class="flex items-center justify-center col-start-1 col-end-12">
          {{isAddIncomeActive ? 'Insert Income' : isAddOutcomeActive ? 'Insert Outcome' : 'Pilih Input'}}
        </div>
      </div>

        <!-- IS ADD INCOME ACTIVE -->
      <div *ngIf="isAddIncomeActive" class="h-[230px] pt-1 px-1 border border-neutral-900">
        <div class="mt-1 mb-2 flex justify-between" [formGroup]="incomeForm">
          <input
            type="date"
            class="text-xs border border-neutral-500 rounded-md px-2 h-6"
            name=""
            id=""
            formControlName="dateIncome"
          />
          <input
            formControlName="description"
            type="text"
            name=""
            id=""
            placeholder="Description"
            class="text-xs border border-neutral-500 rounded-md px-2 h-6 flex-grow ml-2"
          />
        </div>
        <div class="h-[66%] overflow-auto modifscrollbar mb-2">
          <div
            *ngFor="let incCat of incomeInputOptions; let i = index"
            class="flex w-full justify-between mb-1 items-center"
            [ngClass]="i % 2 === 0 ? 'bg-cm-green-500 bg-opacity-20' : ''"
            [formGroup]="incomeForm"
          >
            <label class="text-xs w-[39%] ml-2" [for]="incCat">{{
              incCat
            }}</label>
            <input
              [formControlName]="parseToIncomeProperty(incCat)"
              type="number"
              [name]="incCat"
              [id]="incCat"
              class="border rounded-md border-neutral-500 text-xs text-neutral-800 px-1.5 py-1 w-[58%]"
              [ngClass]="
                i % 2 === 0
                  ? 'bg-transparent text-black placeholder:text-neutral-700'
                  : ''
              "
              placeholder="0"
            />
          </div>
        </div>
        <div class="w-full flex justify-end">
          <app-button
            color="primary"
            size="small"
            (onButtonClick)="onClickAddIncomeDetail()"
            >Add Data</app-button
          >
        </div>
      </div>

        <!-- IS ADD OUTCOME ACTIVE -->
      <div *ngIf="isAddOutcomeActive" class="w-full h-[230px] pt-1 px-1 border border-neutral-900">
        <div class="mt-1 mb-2 flex justify-between" [formGroup]="outcomeForm">
          <input
            type="date"
            class="text-xs border border-neutral-500 rounded-md px-2 h-6"
            name=""
            id=""
            formControlName="dateOutcome"
          />
          <input
            formControlName="description"
            type="text"
            name=""
            id=""
            placeholder="Description"
            class="text-xs border border-neutral-500 rounded-md px-2 h-6 flex-grow ml-2"
          />
        </div>
        <div class="h-[65%]  overflow-auto modifscrollbar mb-2">
          <div
            *ngFor="let outCat of outcomeInputOptions; let i = index"
            class="flex w-full justify-between mb-1 items-center"
            [ngClass]="i % 2 === 0 ? 'bg-red-700 bg-opacity-20' : ''"
            [formGroup]="outcomeForm"
          >
            <label class="text-xs w-[39%] ml-2" [for]="outCat">{{
              outCat
            }}</label>
            <input
              [formControlName]="parseToOutcomeProperty(outCat)"
              type="number"
              [name]="outCat"
              [id]="outCat"
              class="border rounded-md border-neutral-500 text-xs text-neutral-800 px-1.5 py-1 w-[58%]"
              [ngClass]="
                i % 2 === 0
                  ? 'bg-transparent text-black placeholder:text-neutral-700'
                  : ''
              "
              placeholder="0"
            />
          </div>
        </div>
        <div class="w-full flex justify-end">
          <app-button
            color="primary"
            size="small"
            (onButtonClick)="onClickAddIncomeDetail()"
            >Add Data</app-button
          >
        </div>
      </div>
      
    </div>

  </div>

</div>
